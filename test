-- Simple AE2 â†’ Builder Hut Exporter

local colony = peripheral.wrap("top")
local meBridge = peripheral.wrap("bottom")

if not colony then
    print("Colony Integrator NOT found on top")
    return
end
if not meBridge then
    print("ME Bridge NOT found on bottom")
    return
end

print("Colony Integrator detected on top")
print("ME Bridge detected on bottom")

-- Utility: find a side to export items to
local function findExportSide()
    local sides = {"top","bottom","left","right","front","back"}
    for _, side in ipairs(sides) do
        local ok, res = pcall(meBridge.exportItem, meBridge, {name="minecraft:stone", count=1}, side)
        if ok then return side end
    end
    return nil
end

local exportSide = findExportSide()
if not exportSide then
    print("No inventory detected next to ME Bridge to export items!")
    return
else
    print("Exporting to side: "..exportSide)
end

-- Main loop: scan and export requests
while true do
    local requests = colony.getRequests()
    if not requests then
        print("No requests found")
    else
        for _, req in ipairs(requests) do
            if req.target:match("Builder") and req.items and req.items[1] then
                local itemName = req.items[1].name
                local count    = req.count
                local aeItems  = meBridge.listItems()
                local available = 0
                for _, stack in ipairs(aeItems or {}) do
                    if stack.name == itemName then
                        available = stack.count
                        break
                    end
                end

                if availa
